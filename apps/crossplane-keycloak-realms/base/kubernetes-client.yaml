apiVersion: openidclient.keycloak.crossplane.io/v1alpha1
kind: Client
metadata:
  name: kubernetes
spec:
  deletionPolicy: Delete
  forProvider:
    accessType: confidential
    baseUrl: /
    clientId: kubernetes
    clientSecretSecretRef:
      key: OIDC_CLIENT_SECRET
      name: kubernetes-oidc-client
      namespace: crossplane-keycloak-realms
    directAccessGrantsEnabled: true
    name: Kubernetes
    # pkceCodeChallengeMethod: S256
    realmIdRef:
      name: iaas
    rootUrl: http://localhost:8000
    standardFlowEnabled: true
    validRedirectUris:
    - http://localhost:8000
    - https://headlamp.apps.iaas.wcooke.me/oidc-callback
  providerConfigRef:
    name: keycloak-provider-config
---
apiVersion: role.keycloak.crossplane.io/v1alpha1
kind: Role
metadata:
  name: kubernetes-admin
spec:
  deletionPolicy: Delete
  forProvider:
    clientIdRef:
      name: kubernetes
    name: kubernetes-admin
    realmIdRef:
      name: iaas
  providerConfigRef:
    name: keycloak-provider-config
---
apiVersion: group.keycloak.crossplane.io/v1alpha1
kind: Group
metadata:
  name: kubernetes-admins
spec:
  deletionPolicy: Delete
  forProvider:
    name: kubernetes-admins
    realmIdRef:
      name: iaas
  providerConfigRef:
    name: keycloak-provider-config
---
apiVersion: group.keycloak.crossplane.io/v1alpha1
kind: Roles
metadata:
  name: kubernetes-admins-roles
spec:
  deletionPolicy: Delete
  forProvider:
    groupIdRef:
      name: kubernetes-admins
    realmIdRef:
      name: iaas
    roleIdsRefs:
    - name: kubernetes-admin
  providerConfigRef:
    name: keycloak-provider-config
