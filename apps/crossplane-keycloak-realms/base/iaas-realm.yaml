apiVersion: realm.keycloak.crossplane.io/v1alpha1
kind: Realm
metadata:
  name: iaas
spec:
  deletionPolicy: Delete
  forProvider:
    displayName: IaaS
    duplicateEmailsAllowed: false
    enabled: true
    passwordPolicy: length(8) and digits(1) and upperCase(1) and lowerCase(1) and specialChars(1) and forceExpiredPasswordChange(365) and notUsername(undefined)
    realm: iaas
    registrationEmailAsUsername: false
    rememberMe: true
    resetPasswordAllowed: false
    sslRequired: all
    verifyEmail: false
  providerConfigRef:
    name: keycloak-provider-config
---
apiVersion: openidclient.keycloak.crossplane.io/v1alpha1
kind: ClientScope
metadata:
  name: groups
spec:
  deletionPolicy: Delete
  forProvider:
    description: "OpenID Connect scope: include user groups in tokens"
    includeInTokenScope: true
    name: groups
    realmIdRef:
      name: iaas
  providerConfigRef:
    name: keycloak-provider-config
---
apiVersion: realm.keycloak.crossplane.io/v1alpha1
kind: OptionalClientScopes
metadata:
  name: realm-optional-client-scopes
spec:
  deletionPolicy: Delete
  forProvider:
    optionalScopes:
    # Default Scopes
    - address
    - microprofile-jwt
    - offline_access
    - organization
    - phone
    # Custom Scopes
    - groups
    realmIdRef:
      name: iaas
  providerConfigRef:
    name: keycloak-provider-config
---
apiVersion: openidgroup.keycloak.crossplane.io/v1alpha1
kind: GroupMembershipProtocolMapper
metadata:
  name: groups
spec:
  deletionPolicy: Delete
  forProvider:
    addToAccessToken: true
    addToIdToken: true
    addToUserinfo: true
    claimName: groups
    clientScopeIdRef:
      name: groups
    fullPath: false
    name: groups
    realmIdRef:
      name: iaas
  providerConfigRef:
    name: keycloak-provider-config
